(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[915],{40168:function(e,s,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/config-cluster",function(){return r(40309)}])},40309:function(e,s,r){"use strict";r.r(s);var n=r(85893),i=r(67294),t=r(87536),o=r(25934),c=r(71553),l=r(70695),a=r(16960),d=r(72534),u=r(37274),x=r(11163),h=r(43080),p=r(8507),m=r(48847),v=r(76225),g=r(25089),f=r(34155);function j(e,s,r){return s in e?Object.defineProperty(e,s,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[s]=r,e}function b(e){for(var s=1;s<arguments.length;s++){var r=null!=arguments[s]?arguments[s]:{},n=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(s){j(e,s,r[s])}))}return e}var C=function(){var e,s,r,j,C,y,k,$,w=(0,u.o)((function(e){return e.clusterDefinition})),_=(0,t.cI)({mode:"onChange",defaultValues:{operators:h.fI,recipients:h.Ot,singleAddress:"",feeRecipientAddress:"",principal:"",enr:"",name:""}}),A=_.control,S=_.register,T=_.handleSubmit,E=_.formState,R=E.errors,N=E.isDirty,I=E.isValid,O=_.resetField,V=_.setValue,z=_.trigger,D=_.getValues,P=(0,t.Dq)({control:A,name:"operators"}),F=P.fields,W=P.append,Z=P.remove,q=(0,t.Dq)({control:A,name:"recipients"}),L=q.fields,U=q.append,K=q.remove,X=(0,x.useRouter)(),G=(0,u.o)((function(e){return e.completeLeaderStep})),Q=(0,u.o)((function(e){return e.enableLeaderStep})),H=(0,u.o)((function(e){return e.updateClusterDefinition})),M=(0,i.useState)(100),B=M[0],J=M[1],Y=(0,d.kR)(),ee=Y.account,se=(Y.provider,(0,d.pZ)(ee)),re=(0,i.useState)(!!(0,g.c)("non_operator_flow")&&(null===w||void 0===w?void 0:w.nonOperatorFlag)),ne=re[0],ie=re[1],te=(0,d.D9)(ne),oe=(0,i.useState)((null===w||void 0===w?void 0:w.clusterSize)||4),ce=oe[0],le=oe[1],ae=(0,d.D9)(ce),de=(0,i.useState)((null===w||void 0===w?void 0:w.validatorsSize)||1),ue=de[0],xe=de[1],he=(0,i.useState)((function(){return(0,g.c)("single_withdrawal_address_flow")?"single":"splitter"})),pe=he[0],me=he[1],ve=(0,i.useState)([{id:(0,o.Z)(),operator:null,principal:32}]),ge=ve[0],fe=(ve[1],(0,i.useState)()),je=fe[0],be=fe[1],Ce=(0,i.useState)(),ye=Ce[0],ke=Ce[1];return(0,i.useEffect)((function(){pe&&O("singleAddress")}),[pe]),(0,i.useEffect)((function(){ue&&be(32*ue)}),[ue]),(0,i.useEffect)((function(){if(ce){var e=(0,m.zT)(ce);ke(e)}ae&&ae<ce&&W({address:""},{shouldFocus:!1}),ae&&ae>ce&&Z(ce-1)}),[ae,ce]),(0,i.useEffect)((function(){(0,g.c)("non_operator_flow")&&(ne&&W({address:""},{shouldFocus:!1}),1!=te||ne||Z(D().operators.length-1))}),[ne]),(0,i.useEffect)((function(){V("singleAddress",null===w||void 0===w?void 0:w.singleAddress),V("feeRecipientAddress",null===w||void 0===w?void 0:w.feeRecipientAddress),V("enr",null===w||void 0===w?void 0:w.enr),V("name",null===w||void 0===w?void 0:w.name),V("principal",null===w||void 0===w?void 0:w.principal),(null===w||void 0===w?void 0:w.operators)&&V("operators",null===w||void 0===w?void 0:w.operators),(null===w||void 0===w?void 0:w.recipients)&&V("recipients",null===w||void 0===w?void 0:w.recipients)}),[]),(0,n.jsxs)(l.kC,{direction:"column",css:{gap:"$2xl"},children:[(0,n.jsx)(c.xv,{variant:"h3",children:"Configure Cluster"}),(0,n.jsx)(l.l0,{onSubmit:T((function(e){G("config-cluster"),H(b({},e,{creator:{address:ee},validatorsEthAmount:je,nonOperatorFlag:ne}));var s=Q("confirm-configuration");X.push(s.href)})),children:(0,n.jsxs)(l.kC,{direction:"column",css:{gap:"$2xl"},children:[(0,n.jsx)(c.W2,{className:"cluster-details",alignItems:"start",children:(0,n.jsxs)(l.kC,{direction:"column",css:{gap:"$2xl"},children:[(0,n.jsx)(c.xv,{variant:"h4",children:"Cluster Details"}),(0,n.jsxs)(l.kC,{direction:"column",className:"cluster-name-section",css:{gap:"$sm"},children:[(0,n.jsx)(c.xv,{css:{textTransform:"uppercase"},variant:"subline",color:"body",children:"Cluster Name"}),(0,n.jsx)(c.xv,{variant:"metadata",color:"muted",children:"Used to identify your group during configuration process"}),(0,n.jsx)(c.nv,b({},S("name",{required:!0}),{placeholder:"Super Validators",defaultValue:null===w||void 0===w?void 0:w.name}))]}),(0,n.jsxs)(l.kC,{direction:{"@sm":"column"},className:"cluster-size-section",css:{gap:"$3xl"},children:[(0,n.jsxs)(l.kC,{direction:"column",css:{gap:"$sm",width:"auto"},children:[(0,n.jsxs)(l.kC,{css:{alignItems:"center",gap:"$xxxs"},children:[(0,n.jsx)(c.xv,{css:{textTransform:"uppercase"},variant:"subline",color:"body",children:"Cluster Size"}),(0,n.jsx)(c.KZ,{content:"Cluster Size: The number of operators in the cluster. The minimum is 4, for now the maximum is capped at 10.",children:(0,n.jsx)(c.xu,{css:{display:"flex"},children:(0,n.jsx)(c.by,{})})})]}),(0,n.jsx)(a.fx,{name:"clusterSize",value:ce,control:A,onChangeValue:function(e){return le(e)},min:4})]}),(0,n.jsxs)(l.kC,{direction:"column",css:{gap:"$sm",width:"auto"},children:[(0,n.jsxs)(l.kC,{css:{alignItems:"center",gap:"$xxxs"},children:[(0,n.jsx)(c.xv,{css:{textTransform:"uppercase"},variant:"subline",color:"body",children:"Threshold"}),(0,n.jsx)(c.KZ,{content:"Threshold: The number of nodes that need to be functioning for the validator to stay active.",children:(0,n.jsx)(c.xu,{css:{display:"flex"},children:(0,n.jsx)(c.by,{})})})]}),(0,n.jsx)(l.kC,{css:{height:"100%",alignItems:"center"},children:(0,n.jsx)(c.xv,{variant:"h5",css:{color:"$body"},children:"".concat(ye,"/").concat(ce)})})]}),(0,n.jsx)(g.T,{name:"non_operator_flow",children:(0,n.jsxs)(l.kC,{direction:"column",css:{gap:"$sm",width:"auto"},children:[(0,n.jsxs)(l.kC,{css:{alignItems:"center",gap:"$xxxs"},children:[(0,n.jsx)(c.xv,{css:{textTransform:"uppercase"},variant:"subline",color:"body",children:"Non operator"}),(0,n.jsx)(c.KZ,{content:"A flag to indicate you are not an operator in the cluster.",children:(0,n.jsx)(c.xu,{css:{display:"flex"},children:(0,n.jsx)(c.by,{})})})]}),(0,n.jsx)(l.kC,{css:{height:"100%",alignItems:"center"},children:(0,n.jsx)(c.rs,{checked:ne,onCheckedChange:function(){ie(!ne)}})})]})})]}),(0,n.jsxs)(l.kC,{direction:"column",className:"operator-address-section",css:{gap:"$sm"},children:[(0,n.jsx)(c.xv,{css:{textTransform:"uppercase"},variant:"subline",color:"body",children:"Your Address"}),(0,n.jsxs)(l.kC,{direction:"column",css:{gap:"$xxxs"},children:[se&&(0,n.jsx)(c.xv,{color:"white",children:se}),(0,n.jsx)(c.xv,{color:"obolGreen",children:ee})]})]}),F.map((function(e,s){var r,i,t;return(0,n.jsxs)(l.kC,{direction:"column",css:{gap:"$sm","& div > input":{color:"$obolGreen"}},children:[(0,n.jsxs)(l.kC,{direction:"column",css:{gap:"$sm"},children:[(0,n.jsx)(c.xv,{variant:"subline",color:"body",css:{textTransform:"uppercase"},children:"Operator ".concat(ne?s+1:s+2)}),(0,n.jsx)(l.kC,{direction:"column",css:{border:"2px solid $bg04",backgroundColor:"$bg03",borderRadius:"$1",px:"$sm",py:"$xs","&:focus-within":{backgroundColor:"$bg02"}},children:(0,n.jsx)(a.l_,{control:A,name:"operators.".concat(s,".address"),items:D().operators,defaultAddress:ee})})]}),(null===(r=R.operators)||void 0===r?void 0:r[s])&&(0,n.jsx)(c.xv,{variant:"metadata",color:"test",children:null===(t=null===(i=R.operators)||void 0===i?void 0:i[s].address)||void 0===t?void 0:t.message})]},":op".concat(e&&e.id,":"))}))]})}),(0,n.jsxs)(c.W2,{className:"validators-section",alignItems:"start",children:[(0,n.jsxs)(l.kC,{direction:"column",css:{gap:"$xxxs"},children:[(0,n.jsx)(c.xv,{variant:"h4",children:"Validators"}),(0,n.jsx)(c.xv,{size:"4",color:"muted",children:"Select how many Ethereum validators validators you want to run."})]}),(0,n.jsxs)(l.kC,{direction:{"@sm":"column"},css:{gap:"$xl",width:"auto"},children:[(0,n.jsxs)(l.kC,{direction:"column",css:{gap:"$xs"},children:[(0,n.jsx)(c.xv,{css:{textTransform:"uppercase"},variant:"subline",color:"body",children:"Validators"}),(0,n.jsx)(a.fx,{value:ue,onChangeValue:function(e){xe(Number(e))},name:"validatorsSize",control:A,min:1,max:f.env.NEXT_PUBLIC_MAX_VALIDATOR_SIZE&&Number(f.env.NEXT_PUBLIC_MAX_VALIDATOR_SIZE)||250})]}),(0,n.jsxs)(l.kC,{direction:"column",css:{gap:"$xs"},children:[(0,n.jsx)(c.xv,{css:{textTransform:"uppercase"},variant:"subline",color:"body",children:"Cost"}),(0,n.jsxs)(l.kC,{css:{gap:"$xxs",height:"100%",alignItems:"center"},children:[(0,n.jsx)(c.Ee,{src:"/assets/eth-icon.svg",alt:"eth",width:24,height:24}),(0,n.jsxs)(c.xv,{css:{textTransform:"uppercase"},variant:"h5",children:[je," Eth"]})]})]})]})]}),!ne&&(0,n.jsxs)(c.W2,{className:"enr-section",alignItems:"start",css:{gap:"$lg"},children:[(0,n.jsxs)(l.kC,{direction:"column",css:{gap:"$sm"},children:[(0,n.jsxs)(l.kC,{css:{alignItems:"center",gap:"$xxxs"},children:[(0,n.jsx)(c.xv,{variant:"subline",color:"body",css:{textTransform:"uppercase"},children:"What is your Charon Client's ENR?"}),(0,n.jsx)(c.KZ,{content:"An ENR is a public key and encoded networking info starting with enr:-...",children:(0,n.jsx)(c.xu,{css:{display:"flex"},children:(0,n.jsx)(c.by,{})})})]}),(0,n.jsx)(a.iA,{control:A,name:"enr"})]}),(0,n.jsxs)(c.rU,{href:"https://docs.obol.tech/docs/next/int/quickstart/group/quickstart-group-leader-creator#step-2-create-and-back-up-a-private-key-for-charon",target:"_blank",children:["How to generate your ENR ",(0,n.jsx)(c.ZJ,{})]})]}),(0,n.jsxs)(c.W2,{className:"withdrawal-section",css:{gap:"$lg"},alignItems:"start",children:[(0,n.jsx)(c.xv,{variant:"h4",children:"Withdrawal Addesses"}),(0,n.jsx)(c.Hc,{value:pe,onValueChange:function(e){return me(p.RJ[e])},defaultValue:(0,g.c)("single_withdrawal_address_flow")?"single":"splitter","aria-label":"View density",children:(0,n.jsxs)(l.kC,{direction:{"@sm":"column"},css:{width:"$full",gap:"$sm"},children:[(0,n.jsx)(g.T,{name:"single_withdrawal_address_flow",children:(0,n.jsxs)(c.xu,{css:{display:"flex",margin:"10px 0",alignItems:"center"},children:[(0,n.jsx)(c.Wr,{value:"single",id:"r2",children:(0,n.jsx)(c.Q4,{})}),(0,n.jsx)(c.qH,{htmlFor:"r2",css:{fontWeight:"$bold",color:"$light"},children:"Single Address"})]})}),(0,n.jsx)(g.T,{name:"reward_split_withdrawal_flow",children:(0,n.jsxs)(c.xu,{css:{display:"flex",margin:"10px 0",alignItems:"center"},children:[(0,n.jsx)(c.Wr,{value:"splitter",id:"r1",children:(0,n.jsx)(c.Q4,{})}),(0,n.jsx)(c.qH,{htmlFor:"r1",css:{fontWeight:"$bold",color:"$light"},children:"Splitter Contract"})]})})]})}),"splitter"===pe?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(c.xv,{color:"body",variant:"body",children:"Enter each recipient\u2019s address and their share. Ownership must\n                add to 100%."}),(0,n.jsx)(c.xv,{color:"body",variant:"body",children:" By default, a 2% of rewards are allocated to be used by Obol\n                for Public Goods."}),(0,n.jsxs)(l.kC,{css:{alignItems:"center",gap:"$xxxs"},children:[(0,n.jsx)(c.xv,{color:"body",variant:"subline",css:{textTransform:"uppercase"},children:"Recipient of Principal"}),(0,n.jsx)(c.KZ,{content:"Address that can claim the first 32 ether of an exited validator",children:(0,n.jsx)(c.xu,{css:{display:"flex"},children:(0,n.jsx)(c.by,{})})})]}),(0,n.jsx)(v.WO,{columns:h.oU,rows:ge,children:(0,n.jsx)(l.kC,{direction:"column",css:{px:"$sm",py:"$xs","&:focus-within":{backgroundColor:"$bg02"}},children:(0,n.jsx)(a.bQ,{control:A,name:"principal"})})}),(null===(e=R.principal)||void 0===e?void 0:e.message)&&(0,n.jsx)(c.xv,{variant:"metadata",color:"test",children:null===(s=R.principal)||void 0===s?void 0:s.message}),(0,n.jsxs)(l.kC,{css:{alignItems:"center",gap:"$xxxs"},children:[(0,n.jsx)(c.xv,{color:"body",variant:"subline",css:{textTransform:"uppercase"},children:"Reward Split"}),(0,n.jsx)(c.KZ,{content:"Address to receive validator rewards at exit (staking, MEV and fees).",children:(0,n.jsx)(c.xu,{css:{display:"flex"},children:(0,n.jsx)(c.by,{})})})]}),(0,n.jsx)(v.Cl,{columns:h.$y,rows:L,onAddRow:function(){U({address:"",split:""})},onRemoveRow:function(e){K(e);var s=D().recipients.reduce((function(e,s){return s.split?parseFloat(s.split)+e:e}),0);J(s)},totalSplitFooter:B,setMaxSplit:J,control:A,recipients:D().recipients}),(null===(r=R.recipients)||void 0===r?void 0:r.some((function(e){var s;return null===e||void 0===e||null===(s=e.address)||void 0===s?void 0:s.message})))&&(0,n.jsx)(c.xv,{variant:"metadata",color:"test",children:"Please enter a valid, non-duplicate Ethereum address or ENS name"}),(null===(j=R.recipients)||void 0===j?void 0:j.some((function(e){var s;return null===e||void 0===e||null===(s=e.split)||void 0===s?void 0:s.message})))&&(0,n.jsx)(c.xv,{variant:"metadata",color:"test",children:"Split value should be greater than 0%"})]}):(0,n.jsxs)(l.kC,{direction:"column",css:{gap:"$lg"},children:[(0,n.jsxs)(l.kC,{direction:"column",className:"single-address-section",css:{gap:"$xs"},children:[(0,n.jsx)(c.xv,{variant:"h5",children:"Principal Address"}),(0,n.jsxs)(l.kC,{css:{justifyContent:"space-between"},children:[(0,n.jsx)(c.xv,{color:"body",variant:"body",children:"Address to receive validator principal and rewards at exit"}),(0,n.jsx)(c.zx,{ghost:!0,css:{color:"$obolGreen",fontSize:"$1",p:0,height:"100%"},onClick:function(e){e.preventDefault(),V("singleAddress",ee),z("singleAddress")},children:"Use my address"})]}),(0,n.jsx)(l.kC,{direction:"column",css:{border:"2px solid $bg04",backgroundColor:"$bg03",borderRadius:"$1",px:"$sm",py:"$xs","&:focus-within":{backgroundColor:"$bg02"}},children:(0,n.jsx)(a.bQ,{control:A,name:"singleAddress"})}),(null===(C=R.singleAddress)||void 0===C?void 0:C.message)&&(0,n.jsx)(c.xv,{variant:"metadata",color:"test",children:null===(y=R.singleAddress)||void 0===y?void 0:y.message})]}),(0,n.jsxs)(l.kC,{direction:"column",css:{gap:"$xs"},children:[(0,n.jsx)(c.xv,{variant:"h5",children:"Fee Recipient"}),(0,n.jsxs)(l.kC,{direction:"column",className:"fee-recipient-address-section",css:{gap:"$sm"},children:[(0,n.jsxs)(l.kC,{css:{justifyContent:"space-between"},children:[(0,n.jsx)(c.xv,{color:"body",variant:"body",children:"Address to receive transaction fees from block proposals."}),(0,n.jsx)(c.zx,{ghost:!0,css:{color:"$obolGreen",fontSize:"$1",p:0,height:"100%"},onClick:function(e){e.preventDefault(),V("feeRecipientAddress",ee),z("feeRecipientAddress")},children:"Use my address"})]}),(0,n.jsx)(l.kC,{direction:"column",css:{border:"2px solid $bg04",backgroundColor:"$bg03",borderRadius:"$1",px:"$sm",py:"$xs","&:focus-within":{backgroundColor:"$bg02"}},children:(0,n.jsx)(a.bQ,{control:A,name:"feeRecipientAddress"})}),(null===(k=R.feeRecipientAddress)||void 0===k?void 0:k.message)&&(0,n.jsx)(c.xv,{variant:"metadata",color:"test",children:null===($=R.feeRecipientAddress)||void 0===$?void 0:$.message})]})]})]})]}),(0,n.jsx)(l.kC,{direction:"column",children:(0,n.jsx)(c.zx,{color:"primary",type:"submit",disabled:!N||0!==Object.keys(R).length||!I||!ee||100!==B,children:"Create Cluster Configuration"})})]})})]})};s.default=C,C.layout="ProgressTrackerLayout"}},function(e){e.O(0,[774,888,179],(function(){return s=40168,e(e.s=s);var s}));var s=e.O();_N_E=s}]);